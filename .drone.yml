pipeline:
  build:
    image: node:latest
    commands:
      - npm install
      - npm test

#Docker hub settings
#  publish:
#    image: plugins/docker
#    repo: pranay91/cicd_test_app
#    tags: [1, 1.1, latest]
#    secrets: [ docker_username, docker_password ]
  # ssh:
  #   image: appleboy/drone-ssh
  #   host: ec2-35-160-100-109.us-west-2.compute.amazonaws.com
  #   user: ubuntu
  #   port: 22
  #   key_path: /certs/ubuntu_vm_keypair.pem
  #   script:
  #     - echo "test"
  #     - touch testapp
  #   when:
  #     status: success

 #Docker local registry
  # publish:
  #   image: plugins/docker
  #   repo: ec2-34-211-33-89.us-west-2.compute.amazonaws.com:5000/pranay91/cicd_test_app
  #   insecure: true
  #   registry: ec2-34-211-33-89.us-west-2.compute.amazonaws.com:5000
  #   tags: [1, 1.1, latest]
  #   secrets: [docker_username, docker_password]

  # notify:
  #   image: hpreston/drone-spark
  #   auth_token: $SPARK_AUTH
  #   secrets: [ spark_auth ]
  #   roomName: "Drone Build Notifications on Spark"
  #   message: "New Build Successful"

   notify:
     image: pranay91/bobthebuilder
     token: $SPARK_token
     roomname: "Drone Build Notifications on Spark"
     message: "Build Test successful"
     secrets: [spark_token]
