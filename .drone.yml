pipeline:
  build:
    image: node:latest
    secrets: [docker_username, docker_password]
    commands:
      - echo $DOCKER_USERNAME
      - echo $DOCKER_PASSWORD
      - npm install
      - npm test

#Docker hub settings
#  publish:
#    image: plugins/docker
#    repo: pranay91/cicd_test_app
#    tags: [1, 1.1, latest]
#    secrets: [ docker_username, docker_password ]



 #Docker local registry
  publish:
    image: plugins/docker
    repo: ec2-34-211-33-89.us-west-2.compute.amazonaws.com:5000/pranay91/cicd_test_app
    insecure: true
    registry: ec2-34-211-33-89.us-west-2.compute.amazonaws.com:5000
    tags: [1, 1.1, latest]
    secrets: [docker_username, docker_password]
